<?xml version="1.0" encoding="utf-8"?>
<Page
    x:Class="RPISVR_Managements.Classroom.Add_Curriculum.Add_Curriculums"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:RPISVR_Managements.Classroom.Add_Curriculum"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d"
    Background="{ThemeResource ApplicationPageBackgroundThemeBrush}"
    xmlns:converters="using:RPISVR_Managements.Loading_View">

    <Page.Resources>
        <converters:BooleanToVisibilityConverter x:Key="BoolToVisibilityConverter" />
    </Page.Resources>
    
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition x:Name="Text_Header" Height="Auto"/>
            <RowDefinition x:Name="Information_Insert" Height="120"/>
            <RowDefinition x:Name="All_Button" Height="Auto"/>
            <RowDefinition x:Name="Information_Show" Height="5*"/>
        </Grid.RowDefinitions>
        
        <StackPanel x:Name="P_Header" Grid.Row="0" Margin="5">
            <TextBlock x:Name="P_T_Header" 
              Text="បញ្ចូលព័ត៌មានកម្មវិធីសិក្សា" 
              Style="{StaticResource Font_KH_Title}"/>
        </StackPanel>

        <StackPanel x:Name="P_InsertInfomation" Grid.Row="1" Margin="5" Padding="5" CornerRadius="3" BorderBrush="Aqua" BorderThickness="2">
            <ScrollView x:Name="Scroll_P_Insert" MaxHeight="260" ContentOrientation="Horizontal" HorizontalScrollMode="Auto" HorizontalScrollBarVisibility="Visible">
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Left">
                    <TextBox x:Name="txt_Curriculum_ID"
                             IsReadOnly="False"
                             Header="លេខសម្គាល់"
                             Style="{StaticResource Style_KH_TextBox}"
                             Text="{Binding Curriculum_ID,Mode=TwoWay}"
                             BorderBrush="{Binding Curriculum_IDBorderBrush}">

                    </TextBox>
                    <TextBox x:Name="txt_Curriculum_Name_KH"
                             Header="ឈ្មោះមុខវិជ្ជា (ខ្មែរ)"
                             Style="{StaticResource Style_KH_TextBox}"
                             Text="{Binding Curriculum_Name_KH,Mode=TwoWay}"
                             BorderBrush="{Binding Curriculum_Name_KHBorderBrush}">

                    </TextBox>
                    <TextBox x:Name="txt_Curriculum_Name_EN"
                             Header="ឈ្មោះមុខវិជ្ជា (English)"
                             Style="{StaticResource Style_KH_TextBox}"
                             Text="{Binding Curriculum_Name_EN,Mode=TwoWay}"
                             BorderBrush="{Binding Curriculum_Name_ENBorderBrush}">

                    </TextBox>
                    
                    <ComboBox x:Name="txt_Curriculum_Skill_ID"
                                Header="ជំនាញសិក្សា"    
                                ItemsSource="{Binding CurriculumSkill_Combobox}"
                                DisplayMemberPath="Curriculum_Skill_Name"
                                SelectedValuePath="Curriculum_Skill_ID"  
                                Style="{StaticResource Stye_KH_Combobox}"
                                Margin="5,5,0,0"
                                Width="200"
                                SelectedItem="{Binding SelectedCurriculum_Skill_ID,Mode=TwoWay}"
                                BorderBrush="{Binding Curriculum_Skill_IDBorderBrush}">
                    </ComboBox>
                    <ComboBox x:Name="txt_Curriculum_Level"
                                Header="កម្រិតសិក្សា"    
                                ItemsSource="{Binding CurriculumLevel_Combobox}"
                                DisplayMemberPath="Curriculum_Level_Name"
                                SelectedValuePath="Curriculum_Level_ID"  
                                Style="{StaticResource Stye_KH_Combobox}"
                                Margin="5,5,0,0"
                                Width="200"
                                SelectedItem="{Binding SelectedCurriculum_Level_ID,Mode=TwoWay}"
                                BorderBrush="{Binding Curriculum_Level_IDBorderBrush}">
                    </ComboBox>

                    <ComboBox x:Name="txt_Curriculum_Teacher_ID"
                              ItemsSource="{Binding CurriculumTeacher_Combobox}"
                              DisplayMemberPath="Curriculum_Teacher_Name"
                              SelectedValuePath="Curriculum_Teacher_ID"
                              Header="គ្រូបច្ចេកទេស"
                              Margin="10,5,0,0"
                              Style="{StaticResource Stye_KH_Combobox}"
                              SelectedItem="{Binding SelectedCurriculum_Teacher_ID,Mode=TwoWay}"
                              BorderBrush="{Binding Curriculum_Teacher_IDBorderBrush}">

                    </ComboBox>

                    <ComboBox x:Name="txt_Curriculum_Study_Year"
                                Header="ឆ្នាំទី" 
                                Style="{StaticResource Stye_KH_Combobox}"
                                Margin="5"
                                SelectedItem="{Binding Curriculum_Study_Year,Mode=TwoWay}"
                                BorderBrush="{Binding Curriculum_Study_YearBorderBrush}">
                        <x:String>1</x:String>
                        <x:String>2</x:String>
                        <x:String>3</x:String>
                        <x:String>4</x:String>
                        <x:String>4.5</x:String>
                    </ComboBox>
                    
                    <ComboBox x:Name="txt_Curriculum_Semester"
                              Header="ឆមាស"
                              Style="{StaticResource Stye_KH_Combobox}"
                              Margin="10,5,0,0"
                              SelectedItem="{Binding Curriculum_Semester,Mode=TwoWay}"
                              BorderBrush="{Binding Curriculum_SemesterBorderBrush}">
                        <x:String>1</x:String>
                        <x:String>2</x:String>
                    </ComboBox>

                    <NumberBox x:Name="txt_Curriculum_Total_Time"
                               Header="ចំនួនម៉ោងសរុប (h)"
                               Height="70"
                               Width="150"
                               Margin="5,-5,0,0"
                               Text="{Binding Curriculum_Total_Time,Mode=TwoWay}"
                               BorderBrush="{Binding Curriculum_Total_TimeBorderBrush}">

                    </NumberBox>

                    <NumberBox x:Name="txt_Curriculum_Total_Score"
                           Header="ចំនួនពិន្ទុសរុប"
                           Height="70"
                           Width="150"
                           Margin="5,-5,0,0"
                           Text="{Binding Curriculum_Total_Score,Mode=TwoWay}"
                           BorderBrush="{Binding Curriculum_Total_ScoreBorderBrush}">

                    </NumberBox>
                    
                </StackPanel>
            </ScrollView>
        </StackPanel>

        <StackPanel x:Name="P_Button" Grid.Row="2" Orientation="Horizontal" Margin="5,5,15,0" HorizontalAlignment="Right">
            <!-- TextBlock to show error messages -->
            <StackPanel HorizontalAlignment="Left">
                <Image Source="{Binding ErrorImageSource}" Width="30" Height="30" Stretch="Uniform" />
                <TextBlock  Text="{Binding ErrorMessage, Mode=TwoWay}" 
                                Foreground="{Binding MessageColor}" 
                                Margin="10,5,10,0" />
            </StackPanel>

            <Button x:Name="Curr_Add" Style="{StaticResource Stye_KH_Button}" Command="{Binding Command_InsertCurriculum}" IsEnabled="{Binding IsInsertEnabled}">
                <Button.Resources>
                    <SolidColorBrush x:Key="ButtonBackgroundPointerOver" Color="#605EFF" />
                </Button.Resources>
                <StackPanel Orientation="Horizontal">
                    <Image Source="/Assets/Student_Info_Icon/icons8-add-48.png" Width="25" Height="25" Margin="0,0,20,0"/>
                    <TextBlock Text="បញ្ចូល" Margin="30,0,0,0"/>
                </StackPanel>
            </Button>
            <Button x:Name="Curr_Update" Command="{Binding Command_InsertCurriculum}" IsEnabled="{Binding IsUpdateEnabled}" Style="{StaticResource Stye_KH_Button}">
                <Button.Resources>
                    <SolidColorBrush x:Key="ButtonBackgroundPointerOver" Color="#605EFF" />
                </Button.Resources>
                <StackPanel Orientation="Horizontal">
                    <Image Source="/Assets/Student_Info_Icon/icons8-sync-48.png" Width="25" Height="25" Margin="0,0,20,0"/>
                    <TextBlock Text="ធ្វើបច្ចុប្បន្នភាព" Margin="2,0,0,0"/>
                </StackPanel>
            </Button>
            <Button x:Name="Curr_Delete" Command="{Binding Command_Clear_Curriculum}"  Style="{StaticResource Stye_KH_Button}" >
                <Button.Resources>
                    <SolidColorBrush x:Key="ButtonBackgroundPointerOver" Color="#605EFF" />
                </Button.Resources>
                <StackPanel Orientation="Horizontal">
                    <Image Source="/Assets/Student_Info_Icon/icons8-broom-96.png" Width="25" Height="25" Margin="0,0,20,0"/>
                    <TextBlock Text="សម្អាតទិន្នន័យ" Margin="10,0,0,0"/>
                </StackPanel>
            </Button>

        </StackPanel>

        <Grid x:Name="Informations_Show" Grid.Row="3" Margin="5" BorderBrush="Aqua" BorderThickness="2" CornerRadius="3">

            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="230"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <Grid Grid.Column="0">

                <ScrollView x:Name="Search_Infos" VerticalScrollMode="Enabled" Width="250">
                    <StackPanel>
                        <Expander x:Name="Expander_Search" Width="230" CornerRadius="5">
                            <Expander.Header>
                                <StackPanel Orientation="Horizontal">
                                    <Image Source="/Assets/Check_Student_Info_Icon/icons8-search-96.png" Width="28" Height="28"/>
                                    <TextBlock Text="ស្វែងរកទិន្នន័យ"
                                                 x:Name="Text_Search"
                                                 Padding="10,5,0,0"
                                                 Style="{StaticResource Font_KH_Body}"/>
                                </StackPanel>
                            </Expander.Header>
                            <Expander.Content>
                                <StackPanel HorizontalAlignment="Left" VerticalAlignment="Top">
                                    <TextBox x:Name="Search"
                                              Text="{Binding SearchCurriculumInfo, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                              Header="ស្វែងរក"
                                              Style="{StaticResource Style_KH_TextBox}"
                                              Margin="0,0,5,0"
                                              Width="180"
                                              CornerRadius="3"/>
                                </StackPanel>
                            </Expander.Content>
                        </Expander>

                        <Expander x:Name="Expander_Edit" Width="230" CornerRadius="5">
                            <Expander.Header>
                                <StackPanel Orientation="Horizontal">
                                    <Image Source="/Assets/Student_Info_Icon/icons8-edit-100.png" Width="28" Height="28" />
                                    <TextBlock Text="កែសម្រួលទិន្នន័យ"
                                             x:Name="Text_Edit"
                                             Padding="10,5,0,0"
                                             Style="{StaticResource Font_KH_Body}"/>
                                </StackPanel>
                            </Expander.Header>
                            <Expander.Content>
                                <StackPanel>
                                    <Button x:Name="btn_Edit_Teacher" Command="{Binding Command_Edit_Curriculum}"
                                            Style="{StaticResource Stye_KH_Button}">

                                        <Button.Resources>
                                            <SolidColorBrush x:Key="ButtonBackgroundPointerOver" Color="#605EFF" />
                                            <SolidColorBrush x:Key="ButtonBackground" Color="#066A6E"/>
                                        </Button.Resources>
                                        <Button.Content>

                                            <StackPanel Orientation="Horizontal" Margin="0">
                                                <TextBlock Text="កែសម្រួលទិន្នន័យ"/>
                                            </StackPanel>
                                        </Button.Content>
                                    </Button>
                                    <Button x:Name="btn_Delete_Teacher" Command="{Binding Command_Delete_Curriculum}"
                                            Style="{StaticResource Stye_KH_Button}" >
                                        <Button.Resources>
                                            <SolidColorBrush x:Key="ButtonBackgroundPointerOver" Color="#605EFF" />
                                            <SolidColorBrush x:Key="ButtonBackground" Color="Red"/>
                                        </Button.Resources>
                                        <Button.Content>
                                            <StackPanel Orientation="Horizontal" Margin="0">
                                                <TextBlock Text="លុបទិន្នន័យ"/>
                                            </StackPanel>
                                        </Button.Content>
                                    </Button>
                                </StackPanel>
                            </Expander.Content>
                        </Expander>

                        <Expander x:Name="Expander_Prepare_Class" Width="230" CornerRadius="5">
                            <Expander.Header>
                                <StackPanel Orientation="Horizontal">
                                    <Image Source="/Assets/Classes/icons8-class-96.png" Width="28" Height="28" />
                                    <TextBlock Text="រៀបចំថ្នាក់រៀន"
                     x:Name="Text_Prepare_"
                     Padding="10,5,0,0"
                     Style="{StaticResource Font_KH_Body}"/>
                                </StackPanel>
                            </Expander.Header>
                            <Expander.Content>
                                <StackPanel >
                                    <Button x:Name="btn_prepare_class" Click="btn_open_prepare_class" Style="{StaticResource Stye_KH_Button}">
                                        <Button.Resources>
                                            <SolidColorBrush x:Key="ButtonBackgroundPointerOver" Color="#605EFF" />
                                            <SolidColorBrush x:Key="ButtonBackground" Color="DarkGreen"/>
                                        </Button.Resources>
                                        <Button.Content>

                                            <StackPanel Orientation="Horizontal" Margin="0">
                                                <TextBlock Text="រៀបចំថ្នាក់រៀន"/>
                                            </StackPanel>
                                        </Button.Content>
                                    </Button>
                                </StackPanel>
                            </Expander.Content>
                        </Expander>

                    </StackPanel>
                </ScrollView>
            </Grid>

            <Grid Grid.Column="1">
                <TabView x:Name="TabView_Curriculum_Info" TabCloseRequested="TabView_TabCloseRequested" IsAddTabButtonVisible="False">
                    <TabView.TabItems>
                        <TabViewItem Header="ទិន្នន័យកម្មវិធីសិក្សា" IsClosable="False">
                            <ScrollView>
                                <Grid>
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock HorizontalAlignment="Left" Text="តារាងទិន្នន័យកម្មវិធីសិក្សា" Foreground="Aqua" Style="{StaticResource Font_KH_Title}" FontSize="16" FontWeight="Bold" Margin="0,10,0,10"/>
                                        <ProgressRing x:Name="LoadingIndicator"
                                                Margin="20,0,0,0"
                                                IsActive="{Binding IsLoading}"
                                                Visibility="{Binding IsLoading, Converter={StaticResource BoolToVisibilityConverter}}"
                                                HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                    </StackPanel>

                                    <ScrollView x:Name="Table_Curriculum_Info" Margin="0,50,0,0" ContentOrientation="Horizontal" HorizontalScrollMode="Enabled" VerticalScrollMode="Disabled" HorizontalScrollBarVisibility="Visible">
                                        <StackPanel>
                                            <StackPanel Orientation="Horizontal" Spacing="20" Background="Green">
                                                <TextBlock Text="លេខសម្គាល់" Margin="50,0,0,0" Width="120" Style="{StaticResource Font_KH_Body}" FontWeight="Bold"/>
                                                <TextBlock Text="ជំនាញ" Width="120" Style="{StaticResource Font_KH_Body}" FontWeight="Bold"/>
                                                <TextBlock Text="ឆ្នាំទី" Width="30" Style="{StaticResource Font_KH_Body}" FontWeight="Bold"/>
                                                <TextBlock Text="ឆមាស" Width="70"  Style="{StaticResource Font_KH_Body}" FontWeight="Bold"/>
                                                <TextBlock Text="ឈ្មោះមុខវិជ្ជា (ខ្មែរ)" Width="190" Style="{StaticResource Font_KH_Body}" FontWeight="Bold"/>
                                                <TextBlock Text="ឡាតាំង" Width="120"  Style="{StaticResource Font_KH_Body}" FontWeight="Bold"/>
                                                <TextBlock Text="កម្រិតសិក្សា" Width="120"  Style="{StaticResource Font_KH_Body}" FontWeight="Bold"/>
                                                <TextBlock Text="គ្រូបច្ចេកទេស" Width="90" Style="{StaticResource Font_KH_Body}" FontWeight="Bold"/>
                                                <TextBlock Text="ចំនួនម៉ោងសរុប" Width="100" Style="{StaticResource Font_KH_Body}" FontWeight="Bold"/>
                                                <TextBlock Text="ចំនួនពិន្ទុសរុប" Width="100" Style="{StaticResource Font_KH_Body}" FontWeight="Bold"/>
                                                <TextBlock Text="ID ជំនាញ" Width="60" Style="{StaticResource Font_KH_Body}" FontWeight="Bold"/>
                                                <TextBlock Text="ID គ្រូបច្ចេកទេស" Width="100" Style="{StaticResource Font_KH_Body}" FontWeight="Bold"/>
                                            </StackPanel>
                                            <ScrollView ContentOrientation="Vertical" VerticalScrollMode="Auto" VerticalScrollBarVisibility="Visible">
                                                <ListView x:Name="Curriculum_Info_List" ItemsSource="{Binding Curriculum_Info_List}" SelectionChanged="Selected_Curriculum" ScrollViewer.HorizontalScrollMode="Disabled" ScrollViewer.HorizontalScrollBarVisibility="Hidden" CornerRadius="3" BorderBrush="Red" BorderThickness="3"
                                                            Visibility="{Binding IsLoading, Converter={StaticResource BoolToVisibilityConverter}, ConverterParameter=Invert}" SelectionMode="Multiple" IsMultiSelectCheckBoxEnabled="True">
                                                    <ListView.ItemTemplate>
                                                        <DataTemplate>
                                                            <StackPanel Orientation="Horizontal" Spacing="20" Margin="5">
                                                                <TextBlock Text="{Binding Curriculum_ID}" Margin="0,0,0,0" Width="80"/>
                                                                <TextBlock Text="{Binding Curriculum_Skill_Name}" Width="170" Style="{StaticResource Font_KH_Body}"/>
                                                                <TextBlock Text="{Binding Curriculum_Study_Year}" Width="30"/>
                                                                <TextBlock Text="{Binding Curriculum_Semester}" Width="30"/>
                                                                <TextBlock Text="{Binding Curriculum_Name_KH}" Width="190" Style="{StaticResource Font_KH_Body}"/>
                                                                <TextBlock Text="{Binding Curriculum_Name_EN}" Width="150"/>
                                                                <TextBlock Text="{Binding Curriculum_Level_Name}" Width="120" Style="{StaticResource Font_KH_Body}"/>
                                                                <TextBlock Text="{Binding Curriculum_Teacher_Name}" Width="120" Style="{StaticResource Font_KH_Body}"/>
                                                                <TextBlock Text="{Binding Curriculum_Total_Time}" Width="90"/>
                                                                <TextBlock Text="{Binding Curriculum_Total_Score}" Width="90"/>
                                                                <TextBlock Text="{Binding Curriculum_Skill_ID}" Width="90"/>
                                                                <TextBlock Text="{Binding Curriculum_Teacher_ID}" Width="90"/>
                                                            </StackPanel>
                                                        </DataTemplate>
                                                    </ListView.ItemTemplate>
                                                </ListView>
                                            </ScrollView>
                                        </StackPanel>
                                    </ScrollView>
                                </Grid>
                            </ScrollView>
                        </TabViewItem>

                        <TabViewItem Header="តារាងកម្មវិធីសិក្សា" IsClosable="False">
                            <ScrollView>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>
                                        
                                    </Grid.ColumnDefinitions>

                                    <StackPanel Grid.Column="1" Orientation="Vertical" Margin="0,5,5,0" BorderBrush="Blue" BorderThickness="3" CornerRadius="3">
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock HorizontalAlignment="Left" Text="តារាងទិន្នន័យកម្មវិធីសិក្សា" Foreground="Aqua" Style="{StaticResource Font_KH_Title}" FontSize="16" FontWeight="Bold" Margin="0,10,0,10"/>
                                            
                                        </StackPanel>
                                        <StackPanel Orientation="Horizontal">
                                            <ComboBox x:Name="txt_Search_Curriculum_Skill_ID"
                                                        Header="ជំនាញសិក្សា"    
                                                        ItemsSource="{Binding CurriculumSkill_Combobox}"
                                                        DisplayMemberPath="Curriculum_Skill_Name"
                                                        SelectedValuePath="Curriculum_Skill_ID"  
                                                        Style="{StaticResource Stye_KH_Combobox}"
                                                        Margin="5,5,0,0"
                                                        Width="200"
                                                        SelectedItem="{Binding Selected_Search_Curriculum_Skill_ID,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"
                                                        BorderBrush="Green">
                                            </ComboBox>
                                            <ComboBox x:Name="txt_Search_Curriculum_Level"
                                                        Header="កម្រិតសិក្សា"    
                                                        ItemsSource="{Binding CurriculumLevel_Combobox}"
                                                        DisplayMemberPath="Curriculum_Level_Name"
                                                        SelectedValuePath="Curriculum_Level_ID"  
                                                        Style="{StaticResource Stye_KH_Combobox}"
                                                        Margin="5,5,0,0"
                                                        Width="200"
                                                        SelectedItem="{Binding Selected_Search_Curriculum_Level_ID,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"
                                                        BorderBrush="Green">
                                            </ComboBox>

                                            <ComboBox x:Name="txt_Search_Curriculum_Study_Year"
                                                        Header="ឆ្នាំទី" 
                                                        Style="{StaticResource Stye_KH_Combobox}"
                                                        Margin="5"
                                                        SelectedItem="{Binding Curriculum_Search_Study_Year,Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                        BorderBrush="Green">
                                                <x:String>1</x:String>
                                                <x:String>2</x:String>
                                                <x:String>3</x:String>
                                                <x:String>4</x:String>
                                                <x:String>4.5</x:String>
                                            </ComboBox>
                                            <Button x:Name="btn_Search_Clear"
                                                    Command="{Binding Command_Clear_Search_Year}"                                       
                                                    Margin="-3,30,0,0"
                                                    Foreground="Red"
                                                    ToolTipService.ToolTip="Clear study year.">
                                                <Button.Content>
                                                    <StackPanel>
                                                        <FontIcon Glyph="&#xECC9;" />
                                                    </StackPanel>
                                                </Button.Content>
                                            </Button>
                                            <Button x:Name="btn_Search_Curriculum_info"
                                                    Command="{Binding Command_Search_Currculum}"                                  
                                                    Margin="5,30,0,0"
                                                    ToolTipService.ToolTip="Search">
                                                <Button.Content>
                                                    <StackPanel>
                                                        <FontIcon Glyph="&#xE721;" />
                                                    </StackPanel>
                                                </Button.Content>
                                            </Button>
                                            <ToggleButton x:Name="btn_select_all" Click="Selected_All_Curriculum_Info" Margin="5,30,0,0" ToolTipService.ToolTip="Select all.">
                                                <ToggleButton.Content>
                                                    <StackPanel>
                                                        <FontIcon Glyph="&#xE73D;" Foreground="Green"/>
                                                    </StackPanel>
                                                </ToggleButton.Content>
                                            </ToggleButton>
                                            <Button x:Name="btn_export_to_pdf"
                                                    Command="{Binding Command_Export_Curriclum_To_PDF}"
                                                    Margin="5,30,0,0"
                                                    Foreground="OrangeRed"
                                                    ToolTipService.ToolTip="Export to PDF.">
                                                <Button.Content>
                                                    <StackPanel>
                                                        <FontIcon Glyph="&#xEA90;" />
                                                    </StackPanel>
                                                </Button.Content>
                                            </Button>
                                            <Button x:Name="btn_export_to_excel"
                                                    Command="{Binding Command_Export_Curricum_To_Excel}"
                                                    Margin="5,30,0,0"
                                                    ToolTipService.ToolTip="Export to Excel.">
                                                <Button.Content>
                                                    <StackPanel>
                                                        <Image Source="/Assets/Report_Student_Info_Icon/icons8-excel-96.png" Width="20" Height="20" />
                                                    </StackPanel>
                                                </Button.Content>
                                            </Button>
                                                    
                                            
                                                    
                                        </StackPanel>
                                        
                                        <StackPanel x:Name="List_01" Margin="5,0,0,10">
                                            <ScrollView x:Name="Table_Curriculum_Info1" Margin="0,5,0,0" ContentOrientation="Horizontal" HorizontalScrollMode="Enabled" VerticalScrollMode="Disabled" HorizontalScrollBarVisibility="Visible">
                                                <StackPanel>
                                                    <StackPanel Orientation="Horizontal" Background="Green">
                                                            <TextBlock Text="ឆ្នាំទី" Margin="40,0,0,0" Width="40" Style="{StaticResource Font_KH_Body}" FontWeight="Bold"/>
                                                            <TextBlock Text="ឆមាស" Margin="0,0,0,0" Width="80" Style="{StaticResource Font_KH_Body}" FontWeight="Bold"/>
                                                            <TextBlock Text="ឈ្មោះមុខវិជ្ជា (ខ្មែរ)" Width="200" Style="{StaticResource Font_KH_Body}" FontWeight="Bold"/>
                                                            <TextBlock Text="ឡាតាំង" Width="150"  Style="{StaticResource Font_KH_Body}" FontWeight="Bold"/>
                                                            <TextBlock Text="គ្រូបច្ចេកទេស" Width="160" Style="{StaticResource Font_KH_Body}" FontWeight="Bold"/>
                                                            <TextBlock Text="ជំនាញ" Width="160" Style="{StaticResource Font_KH_Body}" FontWeight="Bold"/>
                                                            <TextBlock Text="កម្រិត" Width="80" Style="{StaticResource Font_KH_Body}" FontWeight="Bold"/>
                                                            <TextBlock Text="ចំនួនម៉ោងសរុប" Width="100" Style="{StaticResource Font_KH_Body}" FontWeight="Bold"/>
                                                            <TextBlock Text="ចំនួនពិន្ទុសរុប" Width="100" Style="{StaticResource Font_KH_Body}" FontWeight="Bold"/>
                                                            <TextBlock Text="លេខសម្គាល់" Width="80" Style="{StaticResource Font_KH_Body}" FontWeight="Bold"/>
                                                            <TextBlock Text="ID ជំនាញ" Width="70" Style="{StaticResource Font_KH_Body}" FontWeight="Bold"/>
                                                            <TextBlock Text="ID គ្រូបច្ចេកទេស" Width="100" Style="{StaticResource Font_KH_Body}" FontWeight="Bold"/>
                                                            <TextBlock Text="ID កម្រិតសិក្សា" Width="100" Style="{StaticResource Font_KH_Body}" FontWeight="Bold"/>
                                                    </StackPanel>
                                                <ScrollView ContentOrientation="Vertical" VerticalScrollMode="Auto" VerticalScrollBarVisibility="Visible">
                                                        <ListView x:Name="Curriculum_Info_Table_Export" ItemsSource="{Binding Curriculum_Info_List_Table}" SelectionChanged="Selected_Curriculum_Export" ScrollViewer.HorizontalScrollMode="Disabled" ScrollViewer.HorizontalScrollBarVisibility="Hidden" CornerRadius="3" BorderBrush="Red" BorderThickness="3"
                                                                Visibility="{Binding IsLoading, Converter={StaticResource BoolToVisibilityConverter}, ConverterParameter=Invert}" SelectionMode="Multiple" IsMultiSelectCheckBoxEnabled="True">
                                                        <ListView.ItemTemplate>
                                                            <DataTemplate>
                                                                <StackPanel Orientation="Horizontal" Spacing="20" Margin="5">
                                                                        <TextBlock Text="{Binding Curriculum_Study_Year}" Width="20"/>
                                                                        <TextBlock Text="{Binding Curriculum_Semester}" Width="20"/>
                                                                        <TextBlock Text="{Binding Curriculum_Name_KH}" Width="190" Style="{StaticResource Font_KH_Body}"/>
                                                                        <TextBlock Text="{Binding Curriculum_Name_EN}" Width="150"/>
                                                                        <TextBlock Text="{Binding Curriculum_Teacher_Name}" Width="120" Style="{StaticResource Font_KH_Body}"/>
                                                                        <TextBlock Text="{Binding Curriculum_Skill_Name}" Width="150" Style="{StaticResource Font_KH_Body}"/>
                                                                        <TextBlock Text="{Binding Curriculum_Level_Name}" Width="100" Style="{StaticResource Font_KH_Body}"/>
                                                                        <TextBlock Text="{Binding Curriculum_Total_Time}" Width="80"/>
                                                                        <TextBlock Text="{Binding Curriculum_Total_Score}" Width="50"/>
                                                                        <TextBlock Text="{Binding Curriculum_ID}" Width="80"/>
                                                                        <TextBlock Text="{Binding Curriculum_Skill_ID}" Width="70"/>
                                                                        <TextBlock Text="{Binding Curriculum_Teacher_ID}" Width="70"/>
                                                                        <TextBlock Text="{Binding Curriculum_Level_ID}" Width="90"/>
                                                                    </StackPanel>
                                                            </DataTemplate>
                                                        </ListView.ItemTemplate>
                                                    </ListView>
                                                </ScrollView>
                                                </StackPanel>
                                            </ScrollView>
                                        </StackPanel>
                                    </StackPanel>

                                    <StackPanel Grid.Column="0" Orientation="Vertical" Margin="0,5,5,0" BorderBrush="Blue" BorderThickness="3" CornerRadius="3">
                                        <StackPanel Orientation="Vertical">
                                            <TextBlock HorizontalAlignment="Left" Text="ទិន្នន័យចំនួនម៉ោងបង្រៀនសរុបរបស់គ្រូបច្ចកទេស " Foreground="Aqua" Style="{StaticResource Font_KH_Title}" FontSize="16" FontWeight="Bold" Margin="0,10,0,0"/>
                                            <TextBlock HorizontalAlignment="Left" Text=" (ផ្អែកតាមកម្មវិធីសិក្សា)" Foreground="Aqua" Style="{StaticResource Font_KH_Title}" FontSize="12" FontWeight="Bold"/>
                                            
                                        </StackPanel>
                                        <StackPanel Orientation="Horizontal" Margin="0,40,0,0">
                                            <TextBlock x:Name="Text_Skill"
                                                       Style="{StaticResource Font_KH_Body}">
                                                <Run Text=" ជំនាញ៖"/>
                                                <Run Text="{Binding Curriculum_Skill_Name,Mode=TwoWay}" Foreground="Aqua"/>
                                            </TextBlock>
                                            <TextBlock x:Name="Text_Level"
                                                       Margin="10,0,0,0"
                                                       Style="{StaticResource Font_KH_Body}">
                                                <Run Text="កម្រិត៖ "/>
                                                <Run Text="{Binding Curriculum_Level_Name,Mode=TwoWay}" Foreground="Aqua"/>
                                            </TextBlock>
                                            <TextBlock x:Name="Text_Year"
                                                       Margin="10,0,0,0"
                                                       Style="{StaticResource Font_KH_Body}">
                                                <Run Text="ឆ្នាំទី៖ "/>
                                                <Run Text="{Binding Search_Study_Year_Curr,Mode=TwoWay}" Foreground="Aqua"/>
                                                <Run Text="{Binding Text_Year,Mode=TwoWay}" Foreground="Aqua"/>
                                            </TextBlock>
                                        </StackPanel>
                                        <StackPanel x:Name="List_Teacher_Time">
                                            <ScrollView x:Name="Table_Curriculum_Info2" Margin="5,5,5,0" ContentOrientation="Horizontal" HorizontalScrollMode="Enabled" VerticalScrollMode="Disabled" HorizontalScrollBarVisibility="Visible">
                                                <StackPanel>
                                                    <StackPanel Orientation="Horizontal" Background="Green">
                                                        <TextBlock Text="ឆ្នាំទី" Margin="15,0,0,0" Width="40" Style="{StaticResource Font_KH_Body}" FontWeight="Bold"/>
                                                        <TextBlock Text="ឆមាស" Width="60" Style="{StaticResource Font_KH_Body}" FontWeight="Bold"/>
                                                        <TextBlock Text="គ្រូបច្ចេកទេស" Width="100" Style="{StaticResource Font_KH_Body}" FontWeight="Bold"/>
                                                        <TextBlock Text="ចំនួនម៉ោងសរុប (h)" Width="110" Margin="0,0,0,0" Style="{StaticResource Font_KH_Body}" FontWeight="Bold"/>
                                                    </StackPanel>

                                                    <ScrollView ContentOrientation="Vertical" VerticalScrollMode="Auto" VerticalScrollBarVisibility="Visible">
                                                        <ListView x:Name="Curriculum_Info_Table3" ItemsSource="{Binding Curriculum_TotalTime_List_Table}" SelectionChanged="Selected_Curriculum" ScrollViewer.HorizontalScrollMode="Disabled" ScrollViewer.HorizontalScrollBarVisibility="Hidden" CornerRadius="3" BorderBrush="Red" BorderThickness="3"
                                                                Visibility="{Binding IsLoading, Converter={StaticResource BoolToVisibilityConverter}, ConverterParameter=Invert}">
                                                            <ListView.ItemTemplate>
                                                                <DataTemplate>
                                                                    <StackPanel Orientation="Horizontal" Spacing="20" Margin="5">
                                                                        <TextBlock Text="{Binding Curriculum_Study_Year}" Width="20"/>
                                                                        <TextBlock Text="{Binding Curriculum_Semester}" Width="20"/>
                                                                        <TextBlock Text="{Binding Curriculum_Teacher_Name}" Width="120" Style="{StaticResource Font_KH_Body}"/>
                                                                        <TextBlock Text="{Binding Curriculum_Total_Time}" Width="80" Foreground="Aqua"/>
                                                                    </StackPanel>
                                                                </DataTemplate>
                                                            </ListView.ItemTemplate>
                                                        </ListView>
                                                    </ScrollView>
                                                </StackPanel>
                                            </ScrollView>
                                        </StackPanel>
                                    </StackPanel>
                                </Grid>
                            </ScrollView>
                        </TabViewItem>
                    </TabView.TabItems>
                </TabView>
            </Grid>
        </Grid>
    </Grid>
</Page>
